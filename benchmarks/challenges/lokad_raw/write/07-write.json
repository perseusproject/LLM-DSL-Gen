{
    "question": "///07-write - write several files using \"partitioned\" keyword and bounds\n\n/// The keyword \"write\" introduces a block used to define a section of vectors, associated to a given table,\n/// to be persisted as a flat file stored in file hosting service named BigFiles.\n/// The contextual keyword \"partitioned\" modifies the behavior of the write block: several files can be written at once.\n\n/// Consider a table named Products where three vectors are defined:\n///  - Product\n///  - Color\n///  - Price\n/// Store the data in \"Products\" table into several tables partitioned by \"Color\" values on BigFiles in a repertory clean.\n/// Use a schema with columns \"Product\", \"Color\" and \"Price\"\n/// Use a path schema with vector \"Color\" as the one use for partitioning\n/// Do not export tables where \"Color\" values are alphabetically greater than \"d\"",
    "answer": "table Products = with\n  [| as Product, as Color    , as Price |]\n  [| \"shirt\"   , \"white,grey\", 10.50    |]\n  [| \"pants\"   , \"blue\"      , 15.00    |]\n  [| \"hat\"     , \"red\"       , 5.25     |]\n\nschema Products with\n  Product : text\n  Color : text\n  Price : number\n\nschema '/clean/Products_{Color}.ion' with\n  schema Products\n\nletter_d = \"d\"\nwhere Products.Color < letter_d\n  write Products partitioned as '/clean/Products_{..letter_d}.ion'\n\n/// this line would write as many files as there are different values in \"Color\" vector, there is a technical limit at 200 files maximum.\n/// this line would also erase all files matching path '/clean/Products_*.ion' where * is a \"Color\" value alphabetically lower than \"d\".",
    "ref": "",
    "type": "coding"
}